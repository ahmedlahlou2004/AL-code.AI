import React, { useState, useEffect } from 'react';
import Editor from '@monaco-editor/react';

function App() {
  const [code, setCode] = useState(`# ุงูุชุจ ููุฏ ุจุงูุซูู ููุง\nprint("ูุฑุญุจูุง ูุง ูุฏ!")`);
  const [output, setOutput] = useState('');
  const [pyodide, setPyodide] = useState(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    const loadPyodide = async () => {
      try {
        const pyodideInstance = await window.loadPyodide({
          indexURL: "https://cdn.jsdelivr.net/pyodide/v0.23.4/full/",
        });
        setPyodide(pyodideInstance);
        setLoading(false);
      } catch (err) {
        setOutput("โ๏ธ ูุดู ุชุญููู Pyodide: " + err);
      }
    };
    loadPyodide();
  }, []);

  const runCode = async () => {
    if (!pyodide) {
      setOutput("ุฌุงุฑู ุชุญููู Pyodide...");
      return;
    }
    let outputText = '';
    pyodide.setStdout({
      batched: (text) => {
        outputText += text;
      },
    });
    try {
      await pyodide.runPythonAsync(code);
      setOutput(outputText || "โ ุชู ุชูููุฐ ุงูููุฏ ุจูุฌุงุญุ ููู ูุง ููุฌุฏ ูุฎุฑุฌุงุช.");
    } catch (err) {
      setOutput("โ๏ธ " + err.toString());
    }
  };

  return (
    <div style={{
      display: 'flex',
      flexDirection: 'row',
      height: '100vh',
      backgroundColor: 'white',
      color: '#000',
      fontFamily: 'JetBrains Mono, monospace',
      padding: '20px',
      gap: '20px'
    }}>
      {/* ูุญุฑุฑ ุงูุฃููุงุฏ */}
      <div style={{ flex: 1, display: 'flex', flexDirection: 'column' }}>
        <h1 style={{ color: '#007acc' }}>๐ท ูุญุฑุฑ ุจุงูุซูู ูุจุงุดุฑ</h1>
        <Editor
          height="80%"
          defaultLanguage="python"
          value={code}
          onChange={(value) => setCode(value)}
          theme="vs-dark"
          options={{ fontSize: 16, minimap: { enabled: false }, automaticLayout: true }}
        />
        <button
          onClick={runCode}
          disabled={loading}
          style={{
            marginTop: '10px',
            padding: '10px',
            border: 'none',
            borderRadius: '8px',
            fontWeight: '600',
            cursor: 'pointer',
            background: loading ? '#ccc' : 'linear-gradient(90deg, #00e5ff, #00ff99)',
            color: loading ? '#666' : '#000',
            transition: 'all 0.3s ease',
            boxShadow: loading ? 'none' : '0 0 10px rgba(0,255,204,0.5)'
          }}
        >
          {loading ? 'ุฌุงุฑู ุงูุชุญููู...' : 'ุชุดุบูู ุงูููุฏ โถ๏ธ'}
        </button>
      </div>

      {/* ูุงูุฐุฉ ุงููุฎุฑุฌุงุช */}
      <div style={{
        flex: 1,
        backgroundColor: '#f5f5f5',
        padding: '20px',
        borderRadius: '10px',
        overflowY: 'auto',
        display: 'flex',
        flexDirection: 'column'
      }}>
        <h2 style={{ color: '#007acc' }}>๐ค ุงููุงุชุฌ:</h2>
        <pre style={{ whiteSpace: 'pre-wrap', flex: 1 }}>{output}</pre>
      </div>
    </div>
  );
}

export default App;
